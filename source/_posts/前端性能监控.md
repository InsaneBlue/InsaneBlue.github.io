---
title: 前端性能监控
date: 2019-01-28 23:17:33
tags: [前端工程化, javascript]
categories: [前端工程化, javascript]
---
# 前端性能监控

<!--more-->

## 性能相关字段解释

### performance

#### navigation

+ redirectCount

  重定向的数量（只读），但是这个接口有同源策略限制，即仅能检测同源的重定向；

+ type

  + 0 : TYPE_NAVIGATE (用户通过常规导航方式访问页面，比如点一个链接，或者一般的get方式)
  + 1 : TYPE_RELOAD (用户通过刷新，包括javascript调用刷新接口等方式访问页面) 
  + 2 : TYPE_BACK_FORWARD (用户通过后退按钮访问本页面)

#### memory

此属性是Chrome 添加的一个非标准扩展，这个属性提供了一个可以获取到基本内存使用情况的对象

+ jsHeapSizeLimit：内存大小限制
+ totalJSHeapSize：可使用的内容
+ usedJSHeapSize：已使用的内容

### timing

| 字段                       | 作用（这里所有时间戳都代表UNIX毫秒时间戳）                   |
| -------------------------- | ------------------------------------------------------------ |
| connectEnd                 | 浏览器与服务器之间的连接建立时的时间戳，连接建立指的是所有握手和认证过程全部结束 |
| connectStart               | HTTP请求开始向服务器发送时的时间戳，如果是持久连接，则等同于fetchStart。 |
| domComplete                | 当前网页DOM结构生成时，也就是Document.readyState属性变为“complete”,并且相应的readystatechange事件触发时的时间戳。 |
| domContentLoadedEventEnd   | 当前网页DOMContentLoaded事件发生时，也就是DOM结构解析完毕、所有脚本运行完成时的时间戳。 |
| domContentLoadedEventStart | 当前网页DOMContentLoaded事件发生时，也就是DOM结构解析完毕、所有脚本开始运行时的时间戳。 |
| domInteractive             | 当前网页DOM结构结束解析、开始加载内嵌资源时，也就是Document.readyState属性变为“interactive”、并且相应的readystatechange事件触发时的时间戳。 |
| domLoading                 | 当前网页DOM结构开始解析时,也就是Document.readyState属性变为“loading”、并且相应的readystatechange事件触发时的时间戳。 |
| domainLookupEnd            | 域名查询结束时的时间戳。如果使用持久连接，或者从本地缓存获取信息的，等同于fetchStart |
| domainLookupStart          | 域名查询开始时的时间戳。如果使用持久连接，或者从本地缓存获取信息的，等同于fetchStart |
| fetchStart                 | 浏览器准备通过HTTP请求去获取页面的时间戳。在检查应用缓存之前发生。 |
| loadEventEnd               | 当前网页load事件的回调函数结束时的时间戳。如果该事件还没有发生，返回0。 |
| loadEventStart             | 当前网页load事件的回调函数开始时的时间戳。如果该事件还没有发生，返回0。 |
| navigationStart            | 当前浏览器窗口的前一个网页关闭，发生unload事件时的时间戳。如果没有前一个网页，就等于fetchStart |
| redirectEnd                | 最后一次重定向完成，也就是Http响应的最后一个字节返回时的时间戳。如果没有重定向，或者上次重定向不是同源的。则为0 |
| redirectStart              | 第一次重定向开始时的时间戳，如果没有重定向，或者上次重定向不是同源的。则为0 |
| requestStart               | 浏览器向服务器发出HTTP请求时（或开始读取本地缓存时）的时间戳。 |
| responseEnd                | 浏览器从服务器收到（或从本地缓存读取）最后一个字节时（如果在此之前HTTP连接已经关闭，则返回关闭时）的时间戳 |
| responseStart              | 浏览器从服务器收到（或从本地缓存读取）第一个字节时的时间戳。 |
| secureConnectionStart      | 浏览器与服务器开始安全链接的握手时的时间戳。如果当前网页不要求安全连接，则返回0 |
| unloadEventEnd             | 如果前一个网页与当前网页属于同一个域下，则表示前一个网页的unload回调结束时的时间戳。如果没有前一个网页，或者之前的网页跳转不是属于同一个域内，则返回值为0。 |
| unloadEventStart           | 如果前一个网页与当前网页属于同一个域下，则表示前一个网页的unload事件发生时的时间戳。如果没有前一个网页，或者之前的网页跳转不是属于同一个域内，则返回值为0。 |

### timeOrigin

返回性能测量开始时的时间的高精度时间戳



## 性能监控指标

| 准备新页面耗时                | fetchStart - navigationStart       |
| ----------------------------- | ---------------------------------- |
| 重定向时间                    | redirectEnd - redirectStart        |
| App Cache时间                 | domainLookupStart - fetchStart     |
| DNS解析时间                   | domainLookupEnd -domainLookupStart |
| TCP连接时间                   | connectEnd - connectStart          |
| request时间                   | responseEnd - requestStart         |
| 请求完毕到DOM树加载           | domInteractive -responseEnd        |
| 构建与解析DOM树，加载资源时间 | domCompleter -domInteractive       |
| load时间                      | loadEventEnd - loadEventStart      |
| 整个页面加载时间              | loadEventEnd -navigationStart      |
| 白屏时间                      | responseStart-navigationStart      |



